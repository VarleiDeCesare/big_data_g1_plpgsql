CREATE OR REPLACE FUNCTION DIMINUI_INGRESSO() 
RETURNS TRIGGER AS
$BODY$
BEGIN
  UPDATE SESSAO
     SET INGRESSOS_DISPONIVEIS = INGRESSOS_DISPONIVEIS - 1
   WHERE COD_SESSAO = NEW.COD_SESSAO;
  RETURN NEW;
END;
$BODY$ LANGUAGE PLPGSQL;

CREATE TRIGGER VENDE_INGRESSO
 AFTER INSERT
    ON RESERVA
   FOR EACH ROW
EXECUTE PROCEDURE DIMINUI_INGRESSO();

INSERT INTO RESERVA(COD_ESPETACULO, COD_SESSAO, COD_PEDIDO, CADEIRA)
VALUES (1, 2, 1,'Cadeira-19');