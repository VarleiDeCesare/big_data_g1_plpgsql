CREATE OR REPLACE FUNCTION AUMENTA_INGRESSO() 
RETURNS TRIGGER AS
$BODY$
BEGIN
  UPDATE SESSAO
     SET INGRESSOS_DISPONIVEIS = INGRESSOS_DISPONIVEIS + 1
   WHERE COD_SESSAO = OLD.COD_SESSAO;
  
  RETURN OLD;
END;
$BODY$ LANGUAGE PLPGSQL;

CREATE TRIGGER DEVOLVE_INGRESSO
 AFTER DELETE
    ON RESERVA
   FOR EACH ROW
EXECUTE PROCEDURE AUMENTA_INGRESSO();

DELETE FROM RESERVA WHERE COD_RESERVA = 11